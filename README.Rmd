---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit README.Rmd -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/",
  out.width = "100%"
)
```

# T3BrapiHelpers

<!-- badges: start -->
[![R-CMD-check](https://github.com/jeanlucj/T3BrapiHelpers/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jeanlucj/T3BrapiHelpers/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

Helpers for working with **BrAPI** services and **The Triticeae Toolbox (T3)**
from R. This package provides small, composable utilities that make it easier to
authenticate, query, and transform BrAPI data into formats suitable for
downstream T3 workflows.

---

## Requirements

This package operates on `BrAPIConnection` R6 objects created by the
**BrAPI** package.

- Install BrAPI from GitHub (not CRAN)
- Functions expect a valid `BrAPIConnection` its methods
- Examples that query live servers require an internet connection

---

## Installation

You can install the development version from GitHub:

```{r How to install}
# install.packages("pak")
pak::pak("jeanlucj/T3BrapiHelpers")
```

---

## Package goals

The main goals of **T3BrapiHelpers** are to:

- simplify common BrAPI queries used in T3 pipelines
- reduce redundant code going from BrAPI responses to data.frames
- make exploratory BrAPI work easier from R

---

## Quick start

```{r Use getAllTrialMetaData}
# Connect to a BrAPI endpoint
brapiConn <- BrAPI::createBrAPIConnection("wheat-sandbox.triticeaetoolbox.org",
                                          is_breedbase = TRUE)

# Retrieve trial metadata for "Wheat"
all_trials <- T3BrapiHelpers::getAllTrialMetaData(brapiConn, "Wheat")
head(all_trials)
```

---

## Typical workflow

A common pattern when using this package is:

1. Connect to a BrAPI server
2. Retrieve core objects (studies, trials, germplasm)
3. Normalize or reshape results
4. Export or pass results to T3 tooling

```{r T3Predictathon2026 trials}
wheatConn <- BrAPI::createBrAPIConnection("wheat.triticeaetoolbox.org",
                                          is_breedbase = TRUE)

predict_trial_vec_Wheat <- c("10673", "10674", "10675", "10676", "10677", "10678", "10679", "10680", "10681")

predict_trial_meta <- predict_trial_vec_Wheat |>
  T3BrapiHelpers::getTrialMetaDataFromTrialVec(wheatConn)

predict_germ <- predict_trial_meta$study_db_id |>
  T3BrapiHelpers::getGermplasmFromTrialVec(wheatConn)

nAccPerTrial <- predict_germ |> dplyr::group_by(studyDbId) |>
  dplyr::summarise(nAccInTrial=dplyr::n())
```

---

## Relationship to other tools

- **BrAPI**: This package assumes familiarity with the BrAPI specification and does not attempt to mirror it completely.

---

## Documentation

Full documentation is available at  
https://jeanlucj.github.io/T3BrapiHelpers/

---

## Development status

This package is under active development.

- APIs may change
- Function names and signatures are not yet stable
- Feedback and issues are welcome

---

## Contributing

Issues are welcome.
Please include a minimal reproducible example when reporting bugs.

---

## License

MIT Â© Jean-Luc Jannink
