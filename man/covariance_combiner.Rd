% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariance_combiner.R
\name{covariance_combiner}
\alias{covariance_combiner}
\title{EM Covariance Combiner}
\usage{
covariance_combiner(
  partial_covs,
  var_indices,
  degrees_freedom = NULL,
  max_iter = 100,
  tol = 1e-06,
  track_loglik = TRUE,
  calc_sampling_cov = FALSE
)
}
\arguments{
\item{partial_covs}{List of partial covariance matrices}

\item{var_indices}{List of zero-based variable indices for each partial
covariance matrix}

\item{degrees_freedom}{Optional numeric vector of degrees of freedom for each
matrix (default: 100 for each)}

\item{max_iter}{Maximum iterations for the EM algorithm (default: 100)}

\item{tol}{Convergence tolerance for the EM algorithm (default: 1e-6)}

\item{track_loglik}{Whether to track log-likelihood values during iterations
(default: TRUE)}

\item{calc_sampling_cov}{Whether to calculate the sampling covariance of the
resulting combined covariance matrix (default: FALSE)}
}
\value{
List containing:
\itemize{
\item psi: The combined covariance matrix
\item sampling_cov: Sampling covariance matrix for the combined covariance matrix
\item loglik_path: Vector of log-likelihood values at each iteration (if track_loglik=TRUE)
}
}
\description{
Implementation of EM algorithm for combining partial covariance
matrices. This function implements the EM algorithm for combining multiple
partially observed covariance matrices into a single combined covariance
matrix.
}
\examples{
\dontrun{
# Create some example data
cov1 <- matrix(c(1.0, 0.5, 0.5, 2.0), nrow=2)
cov2 <- matrix(c(1.5, 0.3, 0.3, 1.8), nrow=2)
cov3 <- matrix(c(2.0, 1.0, 1.0, 3.0), nrow=2)

# Define which variables are observed in each matrix (0-based indices)
idx1 <- c(0, 1)  # Variables 0 and 1 in first matrix
idx2 <- c(1, 2)  # Variables 1 and 2 in second matrix
idx3 <- c(0, 2)  # Variables 0 and 2 in third matrix

# Run the EM algorithm
result <- covariance_combiner(
  partial_covs=list(cov1, cov2, cov3),
  var_indices=list(idx1, idx2, idx3),
  degrees_freedom=c(100, 100, 100), calc_sampling_cov = T
)

# Extract the combined covariance matrix
combined_cov <- result$psi
print(combined_cov)

# Extract the sampling covariance matrix
sampling_cov <- result$sampling_cov
print(sampling_cov)

# Plot the log-likelihood path
if (!is.null(result$loglik_path)) {
  plot(result$loglik_path, type="l",
       xlab="Iteration", ylab="Log-likelihood")
}
}
}
