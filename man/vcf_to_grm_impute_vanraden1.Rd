% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/VCFtoGRM_BeagleImpute_byChatGPT.R
\name{vcf_to_grm_impute_vanraden1}
\alias{vcf_to_grm_impute_vanraden1}
\title{Compute a VanRaden I GRM from a VCF, with optional Beagle imputation}
\usage{
vcf_to_grm_impute_vanraden1(
  vcf_file,
  out_rds,
  impute = c("beagle", "mean"),
  beagle_jar = NULL,
  java = "java",
  beagle_mem_gb = 8,
  beagle_out_prefix = NULL,
  beagle_ref = NULL,
  beagle_map = NULL,
  beagle_ne = NULL,
  beagle_extra_args = list(),
  method_vcf2gds = "biallelic.only",
  block_size = 5000,
  verbose = TRUE
)
}
\arguments{
\item{vcf_file}{Path to input VCF (.vcf or .vcf.gz).}

\item{out_rds}{Path to write the GRM as an .rds file (matrix with dimnames).}

\item{impute}{One of \code{"beagle"} or \code{"mean"}.}

\item{beagle_jar}{Path to Beagle jar file (required if \code{impute="beagle"}).
Beagle 5.5 is distributed as a jar and requires Java 8.  \href{https://faculty.washington.edu/browning/beagle/beagle.html}{oai_citation:3_UW Faculty}}

\item{java}{Path to Java executable (default \code{"java"}).}

\item{beagle_mem_gb}{Memory cap passed to Java as \code{-Xmx<GB>g}.}

\item{beagle_out_prefix}{Output prefix for Beagle output files. If NULL, uses a temp prefix.}

\item{beagle_ref}{Optional reference panel file for Beagle (\code{ref=} argument).}

\item{beagle_map}{Optional genetic map file for Beagle (\code{map=} argument).}

\item{beagle_ne}{Optional effective population size (\code{ne=} argument).}

\item{beagle_extra_args}{Named list of extra Beagle args, e.g. \code{list(window=40, iterations=10)}.}

\item{method_vcf2gds}{Passed to \code{SNPRelate::snpgdsVCF2GDS}. Default uses
\code{"biallelic.only"} for biallelic SNPs.}

\item{block_size}{Number of SNPs per block when streaming genotypes from GDS.}

\item{verbose}{Logical; print progress messages.}
}
\value{
Invisibly returns the GRM matrix (also saved to \code{out_rds}).
}
\description{
Computes the additive genomic relationship matrix (GRM) using VanRaden I:
\deqn{G = ZZ' / (2 * \sum p_j (1-p_j))}
where Z is the centered allele dosage matrix (alt allele dosage minus 2p).
}
\details{
Missing genotypes can be handled in two ways:
\itemize{
\item \code{impute = "beagle"}: run Beagle to phase and impute sporadically missing
genotypes (LD-aware). Beagle is run externally via Java.  \href{https://faculty.washington.edu/browning/beagle/beagle.html}{oai_citation:2_UW Faculty}
\item \code{impute = "mean"}: impute missing genotypes to 2p (so centered value is 0).
}
}
