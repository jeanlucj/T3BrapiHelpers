% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/brapi_germplasm.R
\name{retryQuery}
\alias{retryQuery}
\title{Retry a Function Multiple Times on Error}
\usage{
retryQuery(fun, max_tries = 10, wait = 3, silent = TRUE)
}
\arguments{
\item{fun}{A function of zero arguments (typically an anonymous function)
that encapsulates the operation to attempt.}

\item{max_tries}{Integer. Maximum number of attempts before giving up.
Default is 10.}

\item{wait}{Numeric. Number of seconds to pause between attempts.
Default is 3.}

\item{silent}{Logical. Whether to suppress error messages from failed
attempts. Default is \code{TRUE}.}
}
\value{
The value returned by \code{fun()} if an attempt succeeds; otherwise
\code{NULL} invisibly.
}
\description{
\code{retryQuery()} repeatedly calls a user-supplied function that may throw an
error (e.g., due to network timeouts, temporary API failures, or file I/O
issues). If an error occurs, the function waits a specified number of seconds
and tries again, up to a user-defined maximum number of attempts.
}
\details{
This wrapper is especially useful for BrAPI queries or \code{httr} requests that
intermittently fail but typically succeed on a subsequent attempt.

The function supplied to \code{retry()} is evaluated in the environment where
\code{retry()} is called, so all local variables referenced inside the function are
automatically available. This is safer and more flexible than evaluating
quoted expressions.
\subsection{Behavior}{
\itemize{
\item On the \strong{first successful call}, the returned value is returned
\item If all attempts fail, \code{NULL} is returned invisibly after a final message.
\item Errors generated by failed attempts are suppressed when \code{silent = TRUE}.
}
}
}
\examples{
# A function that fails twice, then succeeds
i <- 0
result <- retry(
  function() {
    i <<- i + 1
    if (i < 3) stop("Temporary failure")
    "Success!"
  },
  max_tries = 5,
  wait = 0.1
)
result

# Example with an httr call (mocked for illustration)
url <- "https://example.org"
path <- "/endpoint"

fake_call <- function() {
  if (runif(1) < 0.7) stop("Simulated flaky network")
  paste("Called:", paste0(url, path))
}

retry(fake_call, max_tries = 5, wait = 0.2)

}
\keyword{internal}
